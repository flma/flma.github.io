<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>ueditor Java版更改上传文件路径 | flma’s blog</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="网上大多说方法都是下载源码来直接修改代码，这种方式不利于版本升级。所以我采用继承、重写来解决ueditor上传路径的问题。">
<meta property="og:type" content="article">
<meta property="og:title" content="ueditor Java版更改上传文件路径">
<meta property="og:url" content="http://yoursite.com/2016/12/30/ueditor Java版更改上传文件路径/index.html">
<meta property="og:site_name" content="flma’s blog">
<meta property="og:description" content="网上大多说方法都是下载源码来直接修改代码，这种方式不利于版本升级。所以我采用继承、重写来解决ueditor上传路径的问题。">
<meta property="og:image" content="http://upload-images.jianshu.io/upload_images/2830312-bd7f179a68231bb0.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="http://upload-images.jianshu.io/upload_images/2830312-6dc109e9b3c3da98.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:updated_time" content="2016-12-30T09:58:00.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="ueditor Java版更改上传文件路径">
<meta name="twitter:description" content="网上大多说方法都是下载源码来直接修改代码，这种方式不利于版本升级。所以我采用继承、重写来解决ueditor上传路径的问题。">
  
    <link rel="alternative" href="/atom.xml" title="flma’s blog" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  <link rel="stylesheet" href="/css/style.css" type="text/css">
</head>
<body>
  <div id="container">
    <div class="left-col">
    <div class="overlay"></div>
<div class="intrude-less">
	<header id="header" class="inner">
		<a href="/" class="profilepic">
			
			<img lazy-src="https://avatars0.githubusercontent.com/u/11660217?v=3&amp;u=4fb6fefe235df9c337123bd297a0be19d51cb06b&amp;s=140" class="js-avatar">
			
		</a>

		<hgroup>
		  <h1 class="header-author"><a href="/">flma</a></h1>
		</hgroup>

		
		<p class="header-subtitle">努力并坚持朝自己的理想前进</p>
		

		
			<div class="switch-btn">
				<div class="icon">
					<div class="icon-ctn">
						<div class="icon-wrap icon-house" data-idx="0">
							<div class="birdhouse"></div>
							<div class="birdhouse_holes"></div>
						</div>
						<div class="icon-wrap icon-ribbon hide" data-idx="1">
							<div class="ribbon"></div>
						</div>
						
						<div class="icon-wrap icon-link hide" data-idx="2">
							<div class="loopback_l"></div>
							<div class="loopback_r"></div>
						</div>
						
						
					</div>
					
				</div>
				<div class="tips-box hide">
					<div class="tips-arrow"></div>
					<ul class="tips-inner">
						<li>菜单</li>
						<li>标签</li>
						
						<li>友情链接</li>
						
						
					</ul>
				</div>
			</div>
		

		<div class="switch-area">
			<div class="switch-wrap">
				<section class="switch-part switch-part1">
					<nav class="header-menu">
						<ul>
						
							<li><a href="/">主页</a></li>
				        
							<li><a href="/archives">所有文章</a></li>
				        
							<li><a href="/tags/java">java教程</a></li>
				        
							<li><a href="/tags/springmvc">springmvc教程</a></li>
				        
							<li><a href="/tags/other">其他</a></li>
				        
						</ul>
					</nav>
					<nav class="header-nav">
						<div class="social">
							
								<a class="github" target="_blank" href="https://github.com/flma" title="github">github</a>
					        
								<a class="weibo" target="_blank" href="http://blog.csdn.net/littlebirdofjava" title="weibo">weibo</a>
					        
						</div>
					</nav>
				</section>
				
				
				<section class="switch-part switch-part2">
					<div class="widget tagcloud" id="js-tagcloud">
						<a href="/tags/Linux/" style="font-size: 10px;">Linux</a> <a href="/tags/axure/" style="font-size: 10px;">axure</a> <a href="/tags/ios/" style="font-size: 10px;">ios</a> <a href="/tags/java/" style="font-size: 16.67px;">java</a> <a href="/tags/other/" style="font-size: 20px;">other</a> <a href="/tags/php/" style="font-size: 13.33px;">php</a> <a href="/tags/springmvc/" style="font-size: 10px;">springmvc</a>
					</div>
				</section>
				
				
				
				<section class="switch-part switch-part3">
					<div id="js-friends">
					
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://blog.csdn.net/littlebirdofjava">csdn</a>
			        
			        </div>
				</section>
				

				
			</div>
		</div>
	</header>				
</div>
    </div>
    <div class="mid-col">
      <nav id="mobile-nav">
  	<div class="overlay">
  		<div class="slider-trigger"></div>
  		<h1 class="header-author js-mobile-header hide">flma</h1>
  	</div>
	<div class="intrude-less">
		<header id="header" class="inner">
			<div class="profilepic">
				<img lazy-src="https://avatars0.githubusercontent.com/u/11660217?v=3&amp;u=4fb6fefe235df9c337123bd297a0be19d51cb06b&amp;s=140" class="js-avatar">
			</div>
			<hgroup>
			  <h1 class="header-author">flma</h1>
			</hgroup>
			
			<p class="header-subtitle">努力并坚持朝自己的理想前进</p>
			
			<nav class="header-menu">
				<ul>
				
					<li><a href="/">主页</a></li>
		        
					<li><a href="/archives">所有文章</a></li>
		        
					<li><a href="/tags/java">java教程</a></li>
		        
					<li><a href="/tags/springmvc">springmvc教程</a></li>
		        
					<li><a href="/tags/other">其他</a></li>
		        
		        <div class="clearfix"></div>
				</ul>
			</nav>
			<nav class="header-nav">
				<div class="social">
					
						<a class="github" target="_blank" href="https://github.com/flma" title="github">github</a>
			        
						<a class="weibo" target="_blank" href="http://blog.csdn.net/littlebirdofjava" title="weibo">weibo</a>
			        
				</div>
			</nav>
		</header>				
	</div>
</nav>
      <div class="body-wrap"><article id="post-ueditor Java版更改上传文件路径" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/12/30/ueditor Java版更改上传文件路径/" class="article-date">
  	<time datetime="2016-12-30T09:58:00.000Z" itemprop="datePublished">2016-12-30</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      ueditor Java版更改上传文件路径
    </h1>
  

      </header>
      
      <div class="article-info article-info-post">
        
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/other/">other</a></li></ul>
	</div>

        

        <div class="clearfix"></div>
      </div>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>网上大多说方法都是下载源码来直接修改代码，这种方式不利于版本升级。所以我采用继承、重写来解决ueditor上传路径的问题。</p>
<a id="more"></a>
<h1 id="下载ueditor，放到目录webapp下，点击下载，目录结构如下：">下载ueditor，放到目录webapp下，<a href="http://ueditor.baidu.com/build/build_down.php?n=ueditor&amp;v=1_4_3_3-utf8-jsp" target="_blank" rel="external">点击下载</a>，目录结构如下：</h1><p><img src="http://upload-images.jianshu.io/upload_images/2830312-bd7f179a68231bb0.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="图片.png"></p>
<h1 id="导入ueditor需要的jar包">导入ueditor需要的jar包</h1><p>由于我是maven项目，直接在pom.xml中添加依赖即可，如果是普通的项目，把jar包放倒webapp/WEB-INF/lib下即可。pom.xml如下</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="title">dependency</span>&gt;</span>    </span><br><span class="line">    <span class="tag">&lt;<span class="title">groupId</span>&gt;</span>commons-fileupload<span class="tag">&lt;/<span class="title">groupId</span>&gt;</span>  </span><br><span class="line">    <span class="tag">&lt;<span class="title">artifactId</span>&gt;</span>commons-fileupload<span class="tag">&lt;/<span class="title">artifactId</span>&gt;</span>      </span><br><span class="line">    <span class="tag">&lt;<span class="title">version</span>&gt;</span>1.3.1<span class="tag">&lt;/<span class="title">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="title">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">groupId</span>&gt;</span>org.json<span class="tag">&lt;/<span class="title">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">artifactId</span>&gt;</span>json<span class="tag">&lt;/<span class="title">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">version</span>&gt;</span>20160810<span class="tag">&lt;/<span class="title">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="title">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>这里要单独说下ueditor-1.1.2.jar如何在maven中添加本地依赖</p>
</blockquote>
<ul>
<li>将ueditor-1.1.2.jar放入webapp/WEB-INF/lib下，如下<br><img src="http://upload-images.jianshu.io/upload_images/2830312-6dc109e9b3c3da98.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="图片.png"></li>
<li>在pom.xml中添加依赖</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="title">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">groupId</span>&gt;</span>com.baidu<span class="tag">&lt;/<span class="title">groupId</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--自定义--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">artifactId</span>&gt;</span>ueditor<span class="tag">&lt;/<span class="title">artifactId</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--自定义--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">version</span>&gt;</span>1.0<span class="tag">&lt;/<span class="title">version</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--自定义--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">scope</span>&gt;</span>system<span class="tag">&lt;/<span class="title">scope</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--system，类似provided，需要显式提供依赖的jar以后，Maven就不会在Repository中查找它--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">systemPath</span>&gt;</span>$&#123;pom.basedir&#125;/src/main/webapp/WEB-INF/lib/ueditor-1.1.2.jar<span class="tag">&lt;/<span class="title">systemPath</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--项目根目录下的lib文件夹下--&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="title">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>#编写类UeditorActionEnter.java，由于ueditor主要是通过ActionEnter.java的invoke来进行文件的配置以及上传等操作，所以重写改方法即可。例如上传目录为”/Users/mafengli/upload”,代码如下：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><span class="line">package com.test.ueditor;</span><br><span class="line"><span class="keyword">import</span> com.baidu.ueditor.ActionEnter;</span><br><span class="line"><span class="keyword">import</span> com.baidu.ueditor.ConfigManager;</span><br><span class="line"><span class="keyword">import</span> com.baidu.ueditor.define.ActionMap;</span><br><span class="line"><span class="keyword">import</span> com.baidu.ueditor.define.BaseState;</span><br><span class="line"><span class="keyword">import</span> com.baidu.ueditor.define.State;</span><br><span class="line"><span class="keyword">import</span> com.baidu.ueditor.hunter.FileManager;</span><br><span class="line"><span class="keyword">import</span> com.baidu.ueditor.hunter.ImageHunter;</span><br><span class="line"><span class="keyword">import</span> com.baidu.ueditor.upload.Uploader;</span><br><span class="line"><span class="keyword">import</span> com.wjmfl.tools.Config;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"><span class="comment">/** * Created by mafengli on 16/12/30. */</span></span><br><span class="line">public <span class="class"><span class="keyword">class</span> <span class="title">UeditorActionEnter</span> <span class="keyword">extends</span> <span class="title">ActionEnter</span> </span>&#123;</span><br><span class="line">    private HttpServletRequest request = <span class="literal">null</span>;</span><br><span class="line">    private <span class="built_in">String</span> rootPath = <span class="literal">null</span>;</span><br><span class="line">    private <span class="built_in">String</span> contextPath = <span class="literal">null</span>;</span><br><span class="line">    private <span class="built_in">String</span> actionType = <span class="literal">null</span>;</span><br><span class="line">    private ConfigManager configManager = <span class="literal">null</span>;</span><br><span class="line">    public UeditorActionEnter(HttpServletRequest request, <span class="built_in">String</span> rootPath) &#123;</span><br><span class="line">        <span class="keyword">super</span>(request, rootPath);</span><br><span class="line">        <span class="keyword">this</span>.request = request;</span><br><span class="line">        <span class="keyword">this</span>.rootPath = rootPath;</span><br><span class="line">        <span class="keyword">this</span>.actionType = request.getParameter(<span class="string">"action"</span>);</span><br><span class="line">        <span class="keyword">this</span>.contextPath = request.getContextPath();</span><br><span class="line">        <span class="keyword">this</span>.configManager = ConfigManager.getInstance(<span class="keyword">this</span>.rootPath, <span class="keyword">this</span>.contextPath, request.getRequestURI());</span><br><span class="line">    &#125;    </span><br><span class="line">@Override    </span><br><span class="line">public <span class="built_in">String</span> invoke() &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">this</span>.actionType != <span class="literal">null</span> &amp;&amp; ActionMap.mapping.containsKey(<span class="keyword">this</span>.actionType)) &#123;</span><br><span class="line">            <span class="keyword">if</span> (<span class="keyword">this</span>.configManager != <span class="literal">null</span> &amp;&amp; <span class="keyword">this</span>.configManager.valid()) &#123;</span><br><span class="line">                State state = <span class="literal">null</span>;</span><br><span class="line">                int actionCode = ActionMap.getType(<span class="keyword">this</span>.actionType);</span><br><span class="line">                <span class="built_in">Map</span>&lt;<span class="built_in">String</span>, <span class="built_in">Object</span>&gt; conf = <span class="literal">null</span>;</span><br><span class="line">                <span class="keyword">switch</span> (actionCode) &#123; </span><br><span class="line">                   <span class="keyword">case</span> <span class="number">0</span>: </span><br><span class="line">                       <span class="keyword">return</span> <span class="keyword">this</span>.configManager.getAllConfig().toString();</span><br><span class="line">                    <span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">                    <span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line">                    <span class="keyword">case</span> <span class="number">3</span>:</span><br><span class="line">                    <span class="keyword">case</span> <span class="number">4</span>:</span><br><span class="line">                        conf = <span class="keyword">this</span>.configManager.getConfig(actionCode);</span><br><span class="line">                        <span class="comment">//注意再这里修改rootPath和savePath，上传的实际路径为rootPath＋savePath</span></span><br><span class="line">                        conf.put(<span class="string">"rootPath"</span>, <span class="string">"/Users/mafengli/"</span>);</span><br><span class="line">                        conf.put(<span class="string">"savePath"</span>, <span class="string">"/upload/"</span> + conf.get(<span class="string">"savePath"</span>));</span><br><span class="line">                        state = (<span class="keyword">new</span> Uploader(<span class="keyword">this</span>.request, conf)).doExec();</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    <span class="keyword">case</span> <span class="number">5</span>:</span><br><span class="line">                        conf = <span class="keyword">this</span>.configManager.getConfig(actionCode);</span><br><span class="line">                        <span class="comment">//注意再这里修改rootPath和savePath，上传的实际路径为rootPath＋savePath</span></span><br><span class="line">                        conf.put(<span class="string">"rootPath"</span>, <span class="string">"/Users/mafengli/"</span>);</span><br><span class="line">                        conf.put(<span class="string">"savePath"</span>, <span class="string">"/upload"</span> + conf.get(<span class="string">"savePath"</span>));</span><br><span class="line">                        <span class="built_in">String</span>[] list = <span class="keyword">this</span>.request.getParameterValues((<span class="built_in">String</span>) conf.get(<span class="string">"fieldName"</span>));</span><br><span class="line">                        state = (<span class="keyword">new</span> ImageHunter(conf)).capture(list);</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    <span class="keyword">case</span> <span class="number">6</span>:</span><br><span class="line">                    <span class="keyword">case</span> <span class="number">7</span>:</span><br><span class="line">                        conf = <span class="keyword">this</span>.configManager.getConfig(actionCode);</span><br><span class="line">                       <span class="comment">//注意再这里修改rootPath和savePath，上传的实际路径为rootPath＋savePath</span></span><br><span class="line">                        conf.put(<span class="string">"rootPath"</span>, <span class="string">"/Users/mafengli/"</span>);</span><br><span class="line">                        conf.put(<span class="string">"savePath"</span>, <span class="string">"/upload"</span> + conf.get(<span class="string">"savePath"</span>));</span><br><span class="line">                        conf.put(<span class="string">"dir"</span>, <span class="string">"/upload"</span> + conf.get(<span class="string">"dir"</span>));</span><br><span class="line">                        int start = <span class="keyword">this</span>.getStartIndex();</span><br><span class="line">                        state = (<span class="keyword">new</span> FileManager(conf)).listFile(start);</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">return</span> state.toJSONString();</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">return</span> (<span class="keyword">new</span> BaseState(<span class="literal">false</span>, <span class="number">102</span>)).toJSONString();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> (<span class="keyword">new</span> BaseState(<span class="literal">false</span>, <span class="number">101</span>)).toJSONString();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h1 id="修改ueditor的config-json(ueditor/jsp/)的路径信息:”imagePathFormat”,”scrawlPathFormat”,”snapscreenPathFormat”,”videoPathFormat”,”filePathFormat”,”imageManagerListPath”,”fileManagerListPath”,由于我是在java文件中拼接的upload,所以下列配置全部不带upload">修改ueditor的config.json(ueditor/jsp/)的路径信息:”imagePathFormat”,”scrawlPathFormat”,”snapscreenPathFormat”,”videoPathFormat”,”filePathFormat”,”imageManagerListPath”,”fileManagerListPath”,由于我是在java文件中拼接的upload,所以下列配置全部不带upload</h1><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 前后端通信相关的配置,注释只允许使用多行方式 */</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">/* 上传图片配置项 */</span></span><br><span class="line">    <span class="string">"imageActionName"</span>: <span class="string">"uploadimage"</span>, <span class="comment">/* 执行上传图片的action名称 */</span></span><br><span class="line">    <span class="string">"imageFieldName"</span>: <span class="string">"upfile"</span>, <span class="comment">/* 提交的图片表单名称 */</span></span><br><span class="line">    <span class="string">"imageMaxSize"</span>: <span class="number">2048000</span>, <span class="comment">/* 上传大小限制，单位B */</span></span><br><span class="line">    <span class="string">"imageAllowFiles"</span>: [<span class="string">".png"</span>, <span class="string">".jpg"</span>, <span class="string">".jpeg"</span>, <span class="string">".gif"</span>, <span class="string">".bmp"</span>], <span class="comment">/* 上传图片格式显示 */</span></span><br><span class="line">    <span class="string">"imageCompressEnable"</span>: <span class="literal">true</span>, <span class="comment">/* 是否压缩图片,默认是true */</span></span><br><span class="line">    <span class="string">"imageCompressBorder"</span>: <span class="number">1600</span>, <span class="comment">/* 图片压缩最长边限制 */</span></span><br><span class="line">    <span class="string">"imageInsertAlign"</span>: <span class="string">"none"</span>, <span class="comment">/* 插入的图片浮动方式 */</span></span><br><span class="line">    <span class="string">"imageUrlPrefix"</span>: <span class="string">""</span>, <span class="comment">/* 图片访问路径前缀 */</span></span><br><span class="line">    <span class="string">"imagePathFormat"</span>: <span class="string">"image/&#123;yyyy&#125;&#123;mm&#125;&#123;dd&#125;/&#123;time&#125;&#123;rand:6&#125;"</span>, <span class="comment">/* 上传保存路径,可以自定义保存路径和文件名格式 */</span></span><br><span class="line">                                <span class="comment">/* &#123;filename&#125; 会替换成原文件名,配置这项需要注意中文乱码问题 */</span></span><br><span class="line">                                <span class="comment">/* &#123;rand:6&#125; 会替换成随机数,后面的数字是随机数的位数 */</span></span><br><span class="line">                                <span class="comment">/* &#123;time&#125; 会替换成时间戳 */</span>                                <span class="comment">/* &#123;yyyy&#125; 会替换成四位年份 */</span></span><br><span class="line">                                <span class="comment">/* &#123;yy&#125; 会替换成两位年份 */</span></span><br><span class="line">                                <span class="comment">/* &#123;mm&#125; 会替换成两位月份 */</span></span><br><span class="line">                                <span class="comment">/* &#123;dd&#125; 会替换成两位日期 */</span></span><br><span class="line">                                <span class="comment">/* &#123;hh&#125; 会替换成两位小时 */</span></span><br><span class="line">                                <span class="comment">/* &#123;ii&#125; 会替换成两位分钟 */</span></span><br><span class="line">                                <span class="comment">/* &#123;ss&#125; 会替换成两位秒 */</span></span><br><span class="line">                                <span class="comment">/* 非法字符 \ : * ? " &lt; &gt; | */</span></span><br><span class="line">                                <span class="comment">/* 具请体看线上文档: fex.baidu.com/ueditor/#use-format_upload_filename */</span></span><br><span class="line">    <span class="comment">/* 涂鸦图片上传配置项 */</span></span><br><span class="line">    <span class="string">"scrawlActionName"</span>: <span class="string">"uploadscrawl"</span>, <span class="comment">/* 执行上传涂鸦的action名称 */</span></span><br><span class="line">    <span class="string">"scrawlFieldName"</span>: <span class="string">"upfile"</span>, <span class="comment">/* 提交的图片表单名称 */</span></span><br><span class="line">    <span class="string">"scrawlPathFormat"</span>: <span class="string">"image/&#123;yyyy&#125;&#123;mm&#125;&#123;dd&#125;/&#123;time&#125;&#123;rand:6&#125;"</span>, <span class="comment">/* 上传保存路径,可以自定义保存路径和文件名格式 */</span></span><br><span class="line">    <span class="string">"scrawlMaxSize"</span>: <span class="number">2048000</span>, <span class="comment">/* 上传大小限制，单位B */</span></span><br><span class="line">    <span class="string">"scrawlUrlPrefix"</span>: <span class="string">""</span>, <span class="comment">/* 图片访问路径前缀 */</span></span><br><span class="line">    <span class="string">"scrawlInsertAlign"</span>: <span class="string">"none"</span>,    <span class="comment">/* 截图工具上传 */</span></span><br><span class="line">    <span class="string">"snapscreenActionName"</span>: <span class="string">"uploadimage"</span>, <span class="comment">/* 执行上传截图的action名称 */</span></span><br><span class="line">    <span class="string">"snapscreenPathFormat"</span>: <span class="string">"image/&#123;yyyy&#125;&#123;mm&#125;&#123;dd&#125;/&#123;time&#125;&#123;rand:6&#125;"</span>, <span class="comment">/* 上传保存路径,可以自定义保存路径和文件名格式 */</span></span><br><span class="line">    <span class="string">"snapscreenUrlPrefix"</span>: <span class="string">""</span>, <span class="comment">/* 图片访问路径前缀 */</span></span><br><span class="line">    <span class="string">"snapscreenInsertAlign"</span>: <span class="string">"none"</span>, <span class="comment">/* 插入的图片浮动方式 */</span></span><br><span class="line">    <span class="comment">/* 抓取远程图片配置 */</span></span><br><span class="line">    <span class="string">"catcherLocalDomain"</span>: [<span class="string">"127.0.0.1"</span>, <span class="string">"localhost"</span>, <span class="string">"img.baidu.com"</span>],</span><br><span class="line">    <span class="string">"catcherActionName"</span>: <span class="string">"catchimage"</span>, <span class="comment">/* 执行抓取远程图片的action名称 */</span></span><br><span class="line">    <span class="string">"catcherFieldName"</span>: <span class="string">"source"</span>, <span class="comment">/* 提交的图片列表表单名称 */</span></span><br><span class="line">    <span class="string">"catcherPathFormat"</span>: <span class="string">"image/&#123;yyyy&#125;&#123;mm&#125;&#123;dd&#125;/&#123;time&#125;&#123;rand:6&#125;"</span>, <span class="comment">/* 上传保存路径,可以自定义保存路径和文件名格式 */</span></span><br><span class="line">    <span class="string">"catcherUrlPrefix"</span>: <span class="string">""</span>, <span class="comment">/* 图片访问路径前缀 */</span></span><br><span class="line">    <span class="string">"catcherMaxSize"</span>: <span class="number">2048000</span>, <span class="comment">/* 上传大小限制，单位B */</span></span><br><span class="line">    <span class="string">"catcherAllowFiles"</span>: [<span class="string">".png"</span>, <span class="string">".jpg"</span>, <span class="string">".jpeg"</span>, <span class="string">".gif"</span>, <span class="string">".bmp"</span>], <span class="comment">/* 抓取图片格式显示 */</span></span><br><span class="line">    <span class="comment">/* 上传视频配置 */</span></span><br><span class="line">    <span class="string">"videoActionName"</span>: <span class="string">"uploadvideo"</span>, <span class="comment">/* 执行上传视频的action名称 */</span></span><br><span class="line">    <span class="string">"videoFieldName"</span>: <span class="string">"upfile"</span>, <span class="comment">/* 提交的视频表单名称 */</span></span><br><span class="line">    <span class="string">"videoPathFormat"</span>: <span class="string">"video/&#123;yyyy&#125;&#123;mm&#125;&#123;dd&#125;/&#123;time&#125;&#123;rand:6&#125;"</span>, <span class="comment">/* 上传保存路径,可以自定义保存路径和文件名格式 */</span></span><br><span class="line">    <span class="string">"videoUrlPrefix"</span>: <span class="string">""</span>, <span class="comment">/* 视频访问路径前缀 */</span></span><br><span class="line">    <span class="string">"videoMaxSize"</span>: <span class="number">102400000</span>, <span class="comment">/* 上传大小限制，单位B，默认100MB */</span></span><br><span class="line">    <span class="string">"videoAllowFiles"</span>: [        <span class="string">".flv"</span>, <span class="string">".swf"</span>, <span class="string">".mkv"</span>, <span class="string">".avi"</span>, <span class="string">".rm"</span>, <span class="string">".rmvb"</span>, <span class="string">".mpeg"</span>, <span class="string">".mpg"</span>,        <span class="string">".ogg"</span>, <span class="string">".ogv"</span>, <span class="string">".mov"</span>, <span class="string">".wmv"</span>, <span class="string">".mp4"</span>, <span class="string">".webm"</span>, <span class="string">".mp3"</span>, <span class="string">".wav"</span>, <span class="string">".mid"</span>], <span class="comment">/* 上传视频格式显示 */</span></span><br><span class="line">    <span class="comment">/* 上传文件配置 */</span></span><br><span class="line">    <span class="string">"fileActionName"</span>: <span class="string">"uploadfile"</span>, <span class="comment">/* controller里,执行上传视频的action名称 */</span></span><br><span class="line">    <span class="string">"fileFieldName"</span>: <span class="string">"upfile"</span>, <span class="comment">/* 提交的文件表单名称 */</span></span><br><span class="line">    <span class="string">"filePathFormat"</span>: <span class="string">"file/&#123;yyyy&#125;&#123;mm&#125;&#123;dd&#125;/&#123;time&#125;&#123;rand:6&#125;"</span>, <span class="comment">/* 上传保存路径,可以自定义保存路径和文件名格式 */</span></span><br><span class="line">    <span class="string">"fileUrlPrefix"</span>: <span class="string">""</span>, <span class="comment">/* 文件访问路径前缀 */</span></span><br><span class="line">    <span class="string">"fileMaxSize"</span>: <span class="number">51200000</span>, <span class="comment">/* 上传大小限制，单位B，默认50MB */</span></span><br><span class="line">    <span class="string">"fileAllowFiles"</span>: [        <span class="string">".png"</span>, <span class="string">".jpg"</span>, <span class="string">".jpeg"</span>, <span class="string">".gif"</span>, <span class="string">".bmp"</span>,        <span class="string">".flv"</span>, <span class="string">".swf"</span>, <span class="string">".mkv"</span>, <span class="string">".avi"</span>, <span class="string">".rm"</span>, <span class="string">".rmvb"</span>, <span class="string">".mpeg"</span>, <span class="string">".mpg"</span>,        <span class="string">".ogg"</span>, <span class="string">".ogv"</span>, <span class="string">".mov"</span>, <span class="string">".wmv"</span>, <span class="string">".mp4"</span>, <span class="string">".webm"</span>, <span class="string">".mp3"</span>, <span class="string">".wav"</span>, <span class="string">".mid"</span>,        <span class="string">".rar"</span>, <span class="string">".zip"</span>, <span class="string">".tar"</span>, <span class="string">".gz"</span>, <span class="string">".7z"</span>, <span class="string">".bz2"</span>, <span class="string">".cab"</span>, <span class="string">".iso"</span>,        <span class="string">".doc"</span>, <span class="string">".docx"</span>, <span class="string">".xls"</span>, <span class="string">".xlsx"</span>, <span class="string">".ppt"</span>, <span class="string">".pptx"</span>, <span class="string">".pdf"</span>, <span class="string">".txt"</span>, <span class="string">".md"</span>, <span class="string">".xml"</span>    ], <span class="comment">/* 上传文件格式显示 */</span></span><br><span class="line">    <span class="comment">/* 列出指定目录下的图片 */</span></span><br><span class="line">    <span class="string">"imageManagerActionName"</span>: <span class="string">"listimage"</span>, <span class="comment">/* 执行图片管理的action名称 */</span></span><br><span class="line">    <span class="string">"imageManagerListPath"</span>: <span class="string">"image/"</span>, <span class="comment">/* 指定要列出图片的目录 */</span></span><br><span class="line">    <span class="string">"imageManagerListSize"</span>: <span class="number">20</span>, <span class="comment">/* 每次列出文件数量 */</span></span><br><span class="line">    <span class="string">"imageManagerUrlPrefix"</span>: <span class="string">""</span>, <span class="comment">/* 图片访问路径前缀 */</span></span><br><span class="line">    <span class="string">"imageManagerInsertAlign"</span>: <span class="string">"none"</span>, <span class="comment">/* 插入的图片浮动方式 */</span></span><br><span class="line">    <span class="string">"imageManagerAllowFiles"</span>: [<span class="string">".png"</span>, <span class="string">".jpg"</span>, <span class="string">".jpeg"</span>, <span class="string">".gif"</span>, <span class="string">".bmp"</span>], <span class="comment">/* 列出的文件类型 */</span></span><br><span class="line">    <span class="comment">/* 列出指定目录下的文件 */</span></span><br><span class="line">    <span class="string">"fileManagerActionName"</span>: <span class="string">"listfile"</span>, <span class="comment">/* 执行文件管理的action名称 */</span></span><br><span class="line">    <span class="string">"fileManagerListPath"</span>: <span class="string">"file/"</span>, <span class="comment">/* 指定要列出文件的目录 */</span></span><br><span class="line">    <span class="string">"fileManagerUrlPrefix"</span>: <span class="string">""</span>, <span class="comment">/* 文件访问路径前缀 */</span></span><br><span class="line">    <span class="string">"fileManagerListSize"</span>: <span class="number">20</span>, <span class="comment">/* 每次列出文件数量 */</span></span><br><span class="line">    <span class="string">"fileManagerAllowFiles"</span>: [        <span class="string">".png"</span>, <span class="string">".jpg"</span>, <span class="string">".jpeg"</span>, <span class="string">".gif"</span>, <span class="string">".bmp"</span>,        <span class="string">".flv"</span>, <span class="string">".swf"</span>, <span class="string">".mkv"</span>, <span class="string">".avi"</span>, <span class="string">".rm"</span>, <span class="string">".rmvb"</span>, <span class="string">".mpeg"</span>, <span class="string">".mpg"</span>,        <span class="string">".ogg"</span>, <span class="string">".ogv"</span>, <span class="string">".mov"</span>, <span class="string">".wmv"</span>, <span class="string">".mp4"</span>, <span class="string">".webm"</span>, <span class="string">".mp3"</span>, <span class="string">".wav"</span>, <span class="string">".mid"</span>,        <span class="string">".rar"</span>, <span class="string">".zip"</span>, <span class="string">".tar"</span>, <span class="string">".gz"</span>, <span class="string">".7z"</span>, <span class="string">".bz2"</span>, <span class="string">".cab"</span>, <span class="string">".iso"</span>,        <span class="string">".doc"</span>, <span class="string">".docx"</span>, <span class="string">".xls"</span>, <span class="string">".xlsx"</span>, <span class="string">".ppt"</span>, <span class="string">".pptx"</span>, <span class="string">".pdf"</span>, <span class="string">".txt"</span>, <span class="string">".md"</span>, <span class="string">".xml"</span>    ] <span class="comment">/* 列出的文件类型 */</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>#修改controller.jsp(ueditor/jsp/controller.jsp)</p>
<blockquote>
<p>将out.write..改为如下：(不要忘记修改import)<br>out.write( new UeditorActionEnter( request, rootPath ).exec() );</p>
</blockquote>
<p>具体代码如下：</p>
<figure class="highlight vbscript-html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="xml"></span><span class="vbscript">&lt;%@ page language=<span class="string">"java"</span> contentType=<span class="string">"text/html; charset=UTF-8"</span>  import=<span class="string">"com.wjmfl.ueditor.UeditorActionEnter"</span>    pageEncoding=<span class="string">"UTF-8"</span>%&gt;</span><span class="xml"></span><br><span class="line"></span><span class="vbscript">&lt;%@ page trimDirectiveWhitespaces=<span class="string">"true"</span> %&gt;</span><span class="xml"></span><br><span class="line"></span><span class="vbscript">&lt;%</span><br><span class="line">    <span class="built_in">request</span>.setCharacterEncoding( <span class="string">"utf-8"</span> );</span><br><span class="line">    <span class="built_in">response</span>.setHeader(<span class="string">"Content-Type"</span> , <span class="string">"text/html"</span>);</span><br><span class="line">    <span class="built_in">String</span> rootPath = application.getRealPath( <span class="string">"/"</span> );</span><br><span class="line">    out.write( <span class="keyword">new</span> UeditorActionEnter( <span class="built_in">request</span>, rootPath ).exec() );</span><br><span class="line">%&gt;</span><span class="xml"></span></span><br></pre></td></tr></table></figure>

      
    </div>
    
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2017/02/10/java入门教程(三)基本类型/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption"><</strong>
      <div class="article-nav-title">
        
          java入门教程(三)基本类型
        
      </div>
    </a>
  
  
    <a href="/2016/12/22/springmvc入门教程(一)概念介绍/" id="article-nav-older" class="article-nav-link-wrap">
      <div class="article-nav-title">spring mvc入门教程(一)概念介绍</div>
      <strong class="article-nav-caption">></strong>
    </a>
  
</nav>

  
</article>


<div class="share">
	<!-- JiaThis Button BEGIN -->
	<div class="jiathis_style">
		<span class="jiathis_txt">分享到：</span>
		<a class="jiathis_button_tsina"></a>
		<a class="jiathis_button_cqq"></a>
		<a class="jiathis_button_douban"></a>
		<a class="jiathis_button_weixin"></a>
		<a class="jiathis_button_tumblr"></a>
		<a href="http://www.jiathis.com/share" class="jiathis jiathis_txt jtico jtico_jiathis" target="_blank"></a>
	</div>
	<script type="text/javascript" src="http://v3.jiathis.com/code/jia.js?uid=1405949716054953" charset="utf-8"></script>
	<!-- JiaThis Button END -->
</div>



<div class="duoshuo">
	<!-- 多说评论框 start -->
	<div class="ds-thread" data-thread-key="ueditor Java版更改上传文件路径" data-title="ueditor Java版更改上传文件路径" data-url="http://yoursite.com/2016/12/30/ueditor Java版更改上传文件路径/"></div>
	<!-- 多说评论框 end -->
	<!-- 多说公共JS代码 start (一个网页只需插入一次) -->
	<script type="text/javascript">
	var duoshuoQuery = {short_name:"true"};
	(function() {
		var ds = document.createElement('script');
		ds.type = 'text/javascript';ds.async = true;
		ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
		ds.charset = 'UTF-8';
		(document.getElementsByTagName('head')[0] 
		 || document.getElementsByTagName('body')[0]).appendChild(ds);
	})();
	</script>
	<!-- 多说公共JS代码 end -->
</div>




</div>
      <footer id="footer">
  <div class="outer">
    <div id="footer-info">
    	<div class="footer-left">
    		&copy; 2017 flma
    	</div>
      	<div class="footer-right">
      		<a href="http://hexo.io/" target="_blank">Hexo</a>  Theme <a href="https://github.com/litten/hexo-theme-yilia" target="_blank">Yilia</a> by Litten
      	</div>
    </div>
  </div>
</footer>
    </div>
    
  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css" type="text/css">


<script>
	var yiliaConfig = {
		fancybox: true,
		mathjax: true,
		animate: true,
		isHome: false,
		isPost: true,
		isArchive: false,
		isTag: false,
		isCategory: false,
		open_in_new: false
	}
</script>
<script src="http://7.url.cn/edu/jslib/comb/require-2.1.6,jquery-1.9.1.min.js" type="text/javascript"></script>
<script src="/js/main.js" type="text/javascript"></script>






<script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
        processEscapes: true,
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    }
});

MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';                 
    }       
});
</script>

<script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>


  </div>
</body>
</html>